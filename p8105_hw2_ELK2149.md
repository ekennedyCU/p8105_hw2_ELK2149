Homework 2
================
Evan Kennedy, ELK2149
2025-09-28

\*\*\* Problem 1 \*\*\*

``` r
#separating out date variable, converting month into names of month, converting prez_dem and prez_gop into a single variable, and removing them along with day.

pols_month_df = 
    read_csv("./fivethirtyeight_datasets/pols-month.csv", na = c("NA", ".")) |>
  janitor::clean_names() |> 
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) |> 
  mutate(month = month.name[month]) |> 
  mutate(
    president = case_when(
      prez_dem == 1 ~ "dem",
      prez_gop == 1 ~ "gop")
) |> 
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pols_month_df
```

    ## # A tibble: 822 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

``` r
#separating out date variable by /, converting year to YYYY, converting month to character format, arranging buy year, month, removing day to mirror above data frame.
snp_df = 
    read_csv("./fivethirtyeight_datasets/snp.csv", na = c("NA", ".")) |>
  janitor::clean_names()  |> 
  separate(date, into = c("month", "day", "year"), sep = "/", convert = TRUE) |> 
  mutate(year = ifelse(year >= 47, year + 1900, year + 2000)) |> 
  mutate(month = month.name[month]) |>
  arrange(year) |> 
  select(year, month, everything(), -day)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp_df
```

    ## # A tibble: 787 × 3
    ##     year month     close
    ##    <dbl> <chr>     <dbl>
    ##  1  1950 December   20.4
    ##  2  1950 November   19.5
    ##  3  1950 October    19.5
    ##  4  1950 September  19.5
    ##  5  1950 August     18.4
    ##  6  1950 July       17.8
    ##  7  1950 June       17.7
    ##  8  1950 May        18.8
    ##  9  1950 April      18.0
    ## 10  1950 March      17.3
    ## # ℹ 777 more rows

``` r
# pivoting long, converting month name to be consistent with other data sets.
unemployment_df = 
    read_csv("./fivethirtyeight_datasets/unemployment.csv", na = c("NA", ".")) |>
  janitor::clean_names() |> 
  pivot_longer(
    jan:dec,
    names_to = "month", 
    values_to = "%_UnEmp") |> 
 mutate(month = case_match(
    month,
    "jan" ~ "January",
    "feb" ~ "February",
    "mar" ~ "March",
    "apr" ~ "April",
    "may" ~ "May",
    "jun" ~ "June",
    "jul" ~ "July",
    "aug" ~ "August",
    "sep" ~ "September",
    "oct" ~ "October",
    "nov" ~ "November",
    "dec" ~ "December")
 )
```

    ## Warning: One or more parsing issues, call `problems()` on your data frame for details,
    ## e.g.:
    ##   dat <- vroom(...)
    ##   problems(dat)

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemployment_df
```

    ## # A tibble: 816 × 3
    ##     year month     `%_UnEmp`
    ##    <dbl> <chr>         <dbl>
    ##  1  1948 January         3.4
    ##  2  1948 February        3.8
    ##  3  1948 March           4  
    ##  4  1948 April           3.9
    ##  5  1948 May             3.5
    ##  6  1948 June            3.6
    ##  7  1948 July            3.6
    ##  8  1948 August          3.9
    ##  9  1948 September       3.8
    ## 10  1948 October         3.7
    ## # ℹ 806 more rows

``` r
#join SNP into POLS

pols_snp_df = 
  left_join(pols_month_df, snp_df, by = c("year", "month"))

pols_snp_df
```

    ## # A tibble: 822 × 10
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 January      23      51     253      23      45     198 dem          NA
    ##  2  1947 Februa…      23      51     253      23      45     198 dem          NA
    ##  3  1947 March        23      51     253      23      45     198 dem          NA
    ##  4  1947 April        23      51     253      23      45     198 dem          NA
    ##  5  1947 May          23      51     253      23      45     198 dem          NA
    ##  6  1947 June         23      51     253      23      45     198 dem          NA
    ##  7  1947 July         23      51     253      23      45     198 dem          NA
    ##  8  1947 August       23      51     253      23      45     198 dem          NA
    ##  9  1947 Septem…      23      51     253      23      45     198 dem          NA
    ## 10  1947 October      23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows

``` r
#join unemployment

pols_snp_unemp_df = 
  left_join(pols_snp_df, unemployment_df, by = c("year", "month"))

pols_snp_unemp_df
```

    ## # A tibble: 822 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 January      23      51     253      23      45     198 dem          NA
    ##  2  1947 Februa…      23      51     253      23      45     198 dem          NA
    ##  3  1947 March        23      51     253      23      45     198 dem          NA
    ##  4  1947 April        23      51     253      23      45     198 dem          NA
    ##  5  1947 May          23      51     253      23      45     198 dem          NA
    ##  6  1947 June         23      51     253      23      45     198 dem          NA
    ##  7  1947 July         23      51     253      23      45     198 dem          NA
    ##  8  1947 August       23      51     253      23      45     198 dem          NA
    ##  9  1947 Septem…      23      51     253      23      45     198 dem          NA
    ## 10  1947 October      23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: `%_UnEmp` <dbl>

The variables in this dataset are: year, month, gov_gop, sen_gop,
rep_gop, gov_dem, sen_dem, rep_dem, president, close, %\_UnEmp. The data
was collected between the dates of 1947 and 2015. The dataset has 822
rows and 11 columns. pols_month_df contains data relating to the number
of federal representatives, senators, state governors and president who
represent each party in a given month and year. snp_df contains data on
the S&P stock market score, by month and year. unemployment_df provides
the percent of unemployment in the united states by month and year.

\*\*\* Problem 2 \*\*\*

``` r
# cleaning names, renaming weight and volume to simpler names, converting sports_balls to an interger, creating a categorical variable to differentiate data sets, turning year numeric to be congruent with other datasets.
mr_trash_df = 
  read_excel("./Trash_Data.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N709", na = c("NA", ".")) |>
  janitor::clean_names() |> 
  rename(weight = weight_tons, volume = volume_cubic_yards) |> 
  mutate(sports_balls = as.integer(round(sports_balls)),
         trash_wheel_name = "Mr",
         year = as.numeric(year)
         )
```

``` r
# cleaning names, making weight and volume similar to past data set, creating categorical identifier for this data set
professor_trash_df = 
  read_excel("./Trash_Data.xlsx", sheet = "Professor Trash Wheel", range = "A2:M134", na = c("NA", ".")) |>
  janitor::clean_names() |> 
  rename(weight = weight_tons, volume = volume_cubic_yards) |> 
  mutate(trash_wheel_name = "Prof")
```

``` r
# cleaning names, making weight and volume similar to past data set, creating categorical identifier for this data set
gwynnda_trash_df = 
  read_excel("./Trash_Data.xlsx", sheet = "Gwynns Falls Trash Wheel", range = "A2:L351", na = c("NA", ".")) |>
  janitor::clean_names() |> 
  rename(weight = weight_tons, volume = volume_cubic_yards) |> 
  mutate(trash_wheel_name = "Gwynnda")
```

``` r
# binding datasets together (there is no variable to join them by as they are separate bins)
total_trash_df = 
  bind_rows(mr_trash_df, professor_trash_df, gwynnda_trash_df)
```

The variables in this dataset are: dumpster, month, year, date, weight,
volume, plastic_bottles, polystyrene, cigarette_butts, glass_bottles,
plastic_bags, wrappers, sports_balls, homes_powered, trash_wheel_name.
The data was collected between the dates of 2014 and 2025. The dataset
has a total of 1188 observations. The total weight of trash collected by
Professor Trash Dumpster was 282.26 tons. The total number of cigarette
butts, collected by Gwynnda Trash Dumpster was 18120.

\*\*\* Problem 3 \*\*\*

``` r
# cleaning names for zip codes dataset
zip_codes_df = 
    read_csv("./zillow_data/Zip Codes.csv", na = c("NA", ".")) |>
  janitor::clean_names()
```

    ## Rows: 322 Columns: 7
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (4): County, County Code, File Date, Neighborhood
    ## dbl (3): State FIPS, County FIPS, ZipCode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
# cleaning names for zillow dataset, pivoting long for zori scores across dates, changing zip_code column name to faciliate joining

zip_zori_df = 
    read_csv("./zillow_data/Zip_zori.csv", na = c("NA", ".")) |>
  janitor::clean_names() |> 
  pivot_longer(
    x2015_01_31:x2024_08_31,
    names_to = "date", 
    values_to = "zori") |> 
  rename(zip_code = region_name)
```

    ## Rows: 149 Columns: 125
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr   (6): RegionType, StateName, State, City, Metro, CountyName
    ## dbl (119): RegionID, SizeRank, RegionName, 2015-01-31, 2015-02-28, 2015-03-3...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
# joining datasets
full_zip_df = 
  left_join(zip_codes_df, zip_zori_df, by = "zip_code")
```

    ## Warning in left_join(zip_codes_df, zip_zori_df, by = "zip_code"): Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4757 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

``` r
# cleaning dataset for redundant variables, separating out year month and day for upcoming analysis, regordering columns for ease of reading
full_zip_df = 
  full_zip_df |> 
  mutate(date = str_remove(date, "^x")) |> 
  separate(date, into = c("year", "month", "day"), sep = "_", convert = TRUE) |>
  mutate(month = month.name[month]) |> 
  select(
    zip_code, year, month, day, county, neighborhood, city, state, zori, everything(), -state_fips,
    -county_code, -region_type, -state_name, -metro, -file_date, -county_name
  )
```

The variables in this dataset are: zip_code, year, month, day, county,
neighborhood, city, state, zori, county_fips, region_id, size_rank. The
data was collected between the dates of 2015 and 2024.

The dataset has a total of 17687 observations. There are 320 distinct
zipcodes identified in this data set, and 43 neighborhoods.

The following is a list of zip codes not in the Zillow rental price
dataset: 10464, 10474, 10475, 10499, 10550, 10704, 10705, 10803, 11202,
11224, 11239, 11241, 11242, 11243, 11245, 11247, 11251, 11252, 11256,
10008, 10020, 10041, 10043, 10045, 10047, 10048, 10055, 10072, 10080,
10081, 10082, 10087, 10101, 10102, 10103, 10104, 10105, 10106, 10107,
10108, 10109, 10110, 10111, 10112, 10113, 10114, 10115, 10116, 10117,
10118, 10119, 10120, 10121, 10122, 10123, 10124, 10125, 10126, 10129,
10130, 10131, 10132, 10133, 10138, 10149, 10150, 10151, 10152, 10153,
10154, 10155, 10156, 10157, 10158, 10159, 10160, 10161, 10163, 10164,
10165, 10166, 10167, 10168, 10169, 10170, 10171, 10172, 10173, 10174,
10175, 10176, 10177, 10178, 10179, 10185, 10197, 10199, 10213, 10242,
10249, 10256, 10259, 10260, 10261, 10265, 10268, 10269, 10270, 10271,
10272, 10273, 10274, 10275, 10276, 10277, 10278, 10279, 10281, 10285,
10286, 10292, 11001, 11004, 11005, 11040, 11096, 11351, 11352, 11359,
11362, 11363, 11371, 11380, 11381, 11386, 11405, 11411, 11412, 11413,
11414, 11416, 11417, 11419, 11420, 11421, 11422, 11423, 11424, 11425,
11427, 11428, 11429, 11430, 11431, 11433, 11436, 11439, 11451, 11499,
11559, 11580, 11690, 11694, 11695, 11697, 10302, 10307, 10309, 10310,
10311, 10313

These are likely not in the zillow rental price dataset, because they
are predominantly non-residential areas. For instance, 10464 is Pelham
Bay Park, and 11414 is mostly cross bay blvd, a highway that extends
across Jamaica Bay.

In Jan 2020, average rent cost was 2861.9347505 with a range of
1375.9764477 to 6334.2106678.

In Jan 2021, average rent cost was 2484.1643495 with a range of
1420.3820768 to 5421.614077.

``` r
# pivoting wide to help with comparison between 2020 and 2021 scores
Jan_compare_df = 
  full_zip_df |> 
  filter(month == "January", year %in% c(2020, 2021)) |> 
  select(zip_code, county, neighborhood, year, zori) |> 
  tidyr::pivot_wider(
    names_from = year,
    values_from = zori,
    names_prefix = "zori_"
  )
```

``` r
# generating difference scores between 2021 and 2020
Jan_compare_df =
  Jan_compare_df |> 
   mutate(
    zori_diff = zori_2021 - zori_2020
  )
```

``` r
# creating table of top 10 price drops, using Kable for cleaner output
top_drops = 
  Jan_compare_df |> 
  arrange(zori_diff) |> 
  slice_head(n = 10) |> 
  select(zip_code, county, neighborhood, zori_2020, zori_2021, zori_diff)

kable(
  top_drops,
  caption = "Top 10 ZIP Codes with Largest Rental Price Drops",
  col.names = c("ZIP Code", "Borough", "Neighborhood", "ZORI 2020", "ZORI 2021", "Change")
)
```

| ZIP Code | Borough  | Neighborhood                  | ZORI 2020 | ZORI 2021 |    Change |
|---------:|:---------|:------------------------------|----------:|----------:|----------:|
|    10007 | New York | Lower Manhattan               |  6334.211 |  5421.614 | -912.5966 |
|    10069 | New York | NA                            |  4623.042 |  3874.918 | -748.1245 |
|    10009 | New York | Lower East Side               |  3406.442 |  2692.187 | -714.2550 |
|    10016 | New York | Gramercy Park and Murray Hill |  3731.135 |  3019.431 | -711.7045 |
|    10001 | New York | Chelsea and Clinton           |  4108.098 |  3397.648 | -710.4499 |
|    10002 | New York | Lower East Side               |  3645.416 |  2935.113 | -710.3028 |
|    10004 | New York | Lower Manhattan               |  3149.658 |  2443.697 | -705.9608 |
|    10038 | New York | Lower Manhattan               |  3573.201 |  2875.616 | -697.5853 |
|    10012 | New York | Greenwich Village and Soho    |  3628.566 |  2942.344 | -686.2218 |
|    10010 | New York | Gramercy Park and Murray Hill |  3697.284 |  3012.353 | -684.9304 |

Top 10 ZIP Codes with Largest Rental Price Drops

The largest price drops appear to have occurred in lower Manhattan,
within the Borough of New York.
